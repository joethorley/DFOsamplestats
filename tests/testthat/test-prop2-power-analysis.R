test_that("multiplication works", {
  set.seed(99)
  expect_equal(prop2_power_analysis(0.9, 10), 0.729)
  set.seed(99)
  expect_equal(prop2_power_analysis(0.9, 10), 0.729)
  expect_equal(prop2_power_analysis(0.9, 10), 0.735)
  set.seed(99)
  expect_equal(prop2_power_analysis(0.9, 20), 0.987)
  expect_equal(power.prop.test(n = 10, p1 = 0.9, p2 = 0.1)$power, 0.996493657684712)
  expect_equal(power.prop.test(n = 5, p1 = 0.9, p2 = 0.1)$power, 0.828883800438429)
  expect_equal(prop2_power(0.9, 0.1, 10), 0.996493657684712)
  set.seed(99)
  expect_equal(prop2_power_analysis(0.9, 10, alternative = "two.sided"), 0.729)
  set.seed(99)
  expect_equal(prop2_power_analysis(0.9, 10, alternative = "greater"), 0.729)
  set.seed(99)
  expect_equal(prop2_power_analysis(0.9, 10, alternative = "less"), 0)
  set.seed(99)
  expect_equal(prop2_power_analysis(0.1, 10, alternative = "greater"), 0)
  set.seed(99)
  expect_equal(prop2_power_analysis(0.45, 500), 0.58)
})
