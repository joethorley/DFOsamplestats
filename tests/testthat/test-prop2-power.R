test_that("prop2_power works", {
  expect_equal(prop2_power(0.9, 0.1, 10), 0.996493657684712)
  expect_equal(prop2_power(0.1, 0.9, 10), 0.996493657684712)
  expect_equal(prop2_power(0.01, 0.09, 10), 0.123255356370724)
  expect_equal(prop2_power(0.45, 0.55, 10), 0.0642088359230762)
  expect_equal(prop2_power(0.45, 0.55, 500), 0.886547649491794)
  expect_equal(prop2_power(0.005, 0.0075, 15599), 0.800013338766511)
  expect_equal(prop2_power(0.005, 0.0075, 15599, one_sided = TRUE), 0.876326816946488)
  expect_equal(prop2_power(0.005, 0.0075, 12287, one_sided = TRUE), 0.800006059196688)
})
