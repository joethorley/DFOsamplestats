test_that("rate2_power works", {
  expect_equal(rate2_power(0.9, 1), 0.0266012691095479)
  expect_equal(rate2_power(0.9, 4), 0.274273120172489)
  expect_equal(rate2_power(0.9, 10), 0.828883800438429)
  expect_equal(rate2_power(0.9, 20), 0.996493657684712)
  expect_equal(rate2_power(0.1, 20), 0.996493657684712)
  expect_equal(rate2_power(0.01, p2 = 0.09, 20), 0.123255356370724)
  expect_equal(rate2_power(0.01, 0.09, n = 20), 0.123255356370724)
  expect_equal(rate2_power(0.45, 20), 0.0642088359230762)
  expect_equal(rate2_power(0.45, 1000), 0.886547649491794)
  expect_equal(rate2_power(0.005, p2 = 0.0075, 15599 * 2), 0.800013338766511)
  expect_equal(rate2_power(0.005, p2 = 0.0075, 15599 * 2, alternative = "greater"), 0.876326816946488)
  expect_equal(rate2_power(0.005, p2 = 0.0075, 15599 * 2, alternative = "less"), 0)
})
