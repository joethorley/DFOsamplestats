test_that("rate2_power_analysis_analysis works", {
  expect_equal(rate2_power_analysis(0.9, 1, nsims = 100), 0)
  expect_equal(rate2_power_analysis(0.9, 4, nsims = 100), 0)
  set.seed(99)
  expect_equal(rate2_power_analysis(0.9, 10, nsims = 100), 0.44)
  set.seed(99)
  expect_equal(rate2_power_analysis(0.9, 20, nsims = 100), 0.81)
  set.seed(99)
  expect_equal(rate2_power_analysis(0.1, 20, nsims = 100), 0.81)
  expect_equal(rate2_power_analysis(0.01, p2 = 0.09, 20), 0)
  set.seed(99)
  expect_equal(rate2_power_analysis(0.01, 0.09, n = 200, nsims = 100), 0.44)
  set.seed(99)
  expect_equal(rate2_power_analysis(0.005, p2 = 0.0075, 15599 * 2, nsim = 100), 0.78)
  set.seed(99)
  expect_equal(rate2_power_analysis(0.005, p2 = 0.0075, 15599 * 2, alternative = "greater", nsim = 100), 0.85)
  expect_equal(rate2_power_analysis(0.005, p2 = 0.0075, 15599 * 2, alternative = "less", nsims = 100), 0)
})
